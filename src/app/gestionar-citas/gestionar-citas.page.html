<ion-app>
  <app-menu-header></app-menu-header>

  <ion-content id="main-content">
    <ion-header>
      <ion-toolbar color="primary">
        <ion-buttons slot="start">
          <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-title>Gestionar Citas</ion-title>
      </ion-toolbar>
    </ion-header>

    <div class="container"  *ngIf="mobilaDa">
      <!-- Mostrar citas -->
      <div *ngIf="citas && citas.length > 0" class="citas-container">
        <div *ngFor="let cita of citas" (click)="abrirModal(cita)" class="cita-card">
          <ion-card>
            <ion-card-header>
              <ion-card-title>{{ cita.izena }} - {{ cita.data }}</ion-card-title>
            </ion-card-header>
            <ion-card-content>
              <p>{{ cita.hasiera_ordua }} - {{ cita.amaiera_ordua }}</p>
              <p>{{ cita.deskribapena }}</p>
            </ion-card-content>
          </ion-card>
        </div>
      </div>

      <!-- Modal -->
      <ion-modal [isOpen]="modalAbierto" (ionModalDidDismiss)="cerrarModal()">
        <ng-template>
          <ion-header>
            <ion-toolbar color="primary">
              <ion-title>Detalles de la Cita</ion-title>
              <ion-buttons slot="end">
                <ion-button (click)="cerrarModal()">X</ion-button>
              </ion-buttons>
            </ion-toolbar>
          </ion-header>

          <ion-content class="modal-content">
            <ion-item>
              <ion-label position="stacked">ID:</ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.id"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="stacked">Asiento: </ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.eserlekua"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="stacked">Fecha: </ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.data"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="stacked">Hora de inicio: </ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.hasiera_ordua"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="stacked">Hora de fin: </ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.amaiera_ordua"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="stacked">Nombre: </ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.izena"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="stacked">Teléfono: </ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.telefonoa"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="stacked">Descripción: </ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.deskribapena"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="stacked">De casa: </ion-label>
              <ion-input [(ngModel)]="etxekoa"></ion-input>
            </ion-item>
            
            <ion-item>
              <ion-label position="stacked">Precio Total: </ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.prezio_totala"></ion-input>
            </ion-item>

            <ion-footer>
              <ion-buttons>
                <ion-button style="--background: var(--ion-color-tertiary); --color: white;" (click)="confirmarCambios()">Confirmar</ion-button>
                <ion-button style="--background: var(--ion-color-danger); --color: white;"(click)="cancelarCambios()">Borrar</ion-button>
                <ion-button style="--background: var(--ion-color-warning); --color: white;" (click)="imprimirTicket()">Imprimir Ticket</ion-button>
              </ion-buttons>
            </ion-footer>
          </ion-content>
        </ng-template>
      </ion-modal>
    </div>
    
    <div class="container" *ngIf="!mobilaDa">
    
      <h1>Citas Programadas</h1>
      <table class="citas-table" *ngIf="citas && citas.length > 0">
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Fecha</th>
            <th>Hora Inicio</th>
            <th>Hora Fin</th>
            <th>Descripción</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let cita of citas">
            <td>{{ cita.izena }}</td>
            <td>{{ cita.data }}</td>
            <td>{{ cita.hasiera_ordua }}</td>
            <td>{{ cita.amaiera_ordua }}</td>
            <td>{{ cita.deskribapena }}</td>
            <td>
              <!-- Botón para abrir el modal de detalles -->
              <ion-button (click)="abrirModal(cita)">Ver detalles</ion-button>
            </td>
          </tr>
        </tbody>
      </table>

      <!-- Modal de detalles de la cita -->
      <ion-modal [isOpen]="modalAbierto" (ionModalDidDismiss)="cerrarModal()">
        <ng-template>
          <ion-header>
            <ion-toolbar color="primary">
              <ion-title>Detalles de la Cita</ion-title>
              <ion-buttons slot="end">
                <ion-button (click)="cerrarModal()">X</ion-button>
              </ion-buttons>
            </ion-toolbar>
          </ion-header>

          <ion-content class="modal-content">
            <ion-item>
              <ion-label position="stacked">ID:</ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.id"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="stacked">Asiento:</ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.eserlekua"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="stacked">Fecha:</ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.data"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="stacked">Hora de inicio:</ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.hasiera_ordua"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="stacked">Hora de fin:</ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.amaiera_ordua"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="stacked">Nombre:</ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.izena"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="stacked">Teléfono:</ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.telefonoa"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="stacked">Descripción:</ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.deskribapena"></ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="stacked">De casa:</ion-label>
              <ion-input [(ngModel)]="etxekoa"></ion-input>
            </ion-item>
            
            <ion-item>
              <ion-label position="stacked">Precio Total:</ion-label>
              <ion-input [(ngModel)]="citaSeleccionada.prezio_totala"></ion-input>
            </ion-item>

            <ion-footer>
              <ion-buttons>
                <ion-button style="--background: var(--ion-color-tertiary); --color: white;" (click)="confirmarCambios()">Confirmar</ion-button>
                <ion-button style="--background: var(--ion-color-danger); --color: white;" (click)="cancelarCambios()">Borrar</ion-button>
                <ion-button style="--background: var(--ion-color-warning); --color: white;" (click)="imprimirTicket()">Imprimir Ticket</ion-button>
              </ion-buttons>
            </ion-footer>
          </ion-content>
        </ng-template>
      </ion-modal>
    </div>

  </ion-content>
</ion-app>
